<!DOCTYPE html>
<html lang="bn" class="notranslate" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XG.Sammim | Prayer Pro</title>
    
    <meta name="google" content="notranslate">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Bengali:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.05);
            --gold: #ffcc00;
            --neon: #00d2ff; /* ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶∞‡¶Ç */
        }

        body {
            margin: 0; background: #050a14; color: white;
            font-family: 'Noto Serif Bengali', serif; 
            display: flex; justify-content: center;
            transition: background 0.5s;
        }

        .app { width: 100%; max-width: 400px; padding: 15px; }

        /* ‡¶≤‡ßã‡¶ó‡ßã ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® */
        .mosque-container { cursor: pointer; display: inline-block; transition: transform 0.2s; }
        .mosque-container:active { transform: scale(0.9); }

        .lang-switch { text-align: right; margin-bottom: 10px; }
        .lang-btn {
            background: var(--neon); color: #000; border: none;
            padding: 5px 15px; border-radius: 20px; font-weight: bold;
            cursor: pointer; font-size: 12px; transition: 0.3s;
        }

        #clock { 
            font-size: 3.2rem; text-align: center; margin: 10px 0; 
            font-weight: 800; color: #fff; text-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        .card {
            background: var(--glass); border-radius: 15px; padding: 15px; margin-bottom: 20px;
            border: 1px solid var(--neon); box-shadow: 0 0 15px rgba(0, 210, 255, 0.1); 
            backdrop-filter: blur(10px); transition: 0.3s;
        }

        .mosque-main { font-size: 55px; color: var(--neon); filter: drop-shadow(0 0 10px var(--neon)); transition: 0.3s; }
        .neon-line { height: 2px; width: 60%; background: var(--neon); margin: 10px auto; box-shadow: 0 0 10px var(--neon); transition: 0.3s; }
        .developer-name { font-size: 19px; font-weight: bold; color: #fff; text-align: center; margin: 5px 0;}

        select { 
            width: 100%; padding: 12px; border-radius: 10px; background: var(--glass); 
            color: white; border: 1px solid var(--neon); margin-bottom: 20px; 
            outline: none; font-family: inherit;
        }

        .ramadan-combined { display: flex; justify-content: space-around; text-align: center; align-items: center; }
        .divider { width: 1px; height: 40px; background: rgba(255,255,255,0.2); }
        .ramadan-box span { font-size: 1.5rem; color: var(--gold); font-weight: bold; display: block; }
        .ramadan-box p { font-size: 0.85rem; color: var(--neon); margin: 0; }

        .time-row { display: flex; justify-content: space-between; padding: 15px 5px; border-bottom: 1px solid #222; cursor: pointer; }
        .status-highlight { color: var(--neon); font-weight: bold; }
        .next-time-inline { color: var(--gold); font-weight: bold; margin-left: 5px; }

        /* Modal Styles */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { background: #0a111e; margin: 10% auto; padding: 20px; border: 1px solid var(--neon); width: 85%; border-radius: 15px; max-height: 70vh; overflow-y: auto; }
        
        .list-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 13px; }
        .rakat-info { max-height: 0; opacity: 0; overflow: hidden; background: rgba(255,255,255,0.03); transition: 0.3s; text-align: center; font-size: 12px; color: #ccc;}
        .show-rakat { max-height: 100px; opacity: 1; padding: 10px; border: 1px solid var(--neon); margin: 5px 0; border-radius: 8px; }
    </style>
</head>
<body class="notranslate">
    <div class="app">
        <div class="lang-switch">
            <button class="lang-btn" onclick="toggleLang()" id="langBtn">English</button>
        </div>

        <div class="header-design" style="text-align: center;">
            <div class="mosque-container" onclick="changeThemeColor()">
                <i class="fas fa-mosque mosque-main"></i>
            </div>
            <div class="neon-line"></div>
            <h2 class="developer-name">XG.Sammim | Prayer Pro</h2>
        </div>

        <select id="city" onchange="loadData()">
            <option value="Dhaka">üìç ‡¶¢‡¶æ‡¶ï‡¶æ / Dhaka</option>
            <option value="Sylhet">üìç ‡¶∏‡¶ø‡¶≤‡ßá‡¶ü / Sylhet</option>
            <option value="Chittagong">üìç ‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ / Chittagong</option>
            <option value="Rajshahi">üìç ‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ / Rajshahi</option>
            <option value="Khulna">üìç ‡¶ñ‡ßÅ‡¶≤‡¶®‡¶æ / Khulna</option>
        </select>

        <div class="card">
            <h2 id="clock">00:00:00</h2>
            <p id="today" style="text-align: center; margin: 0;">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
            <p id="hijriDate" class="gold-text" style="text-align: center; margin-top: 5px; font-size: 14px;"></p>
        </div>

        <div class="card ramadan-combined" onclick="showMonthlySchedule()" style="cursor: pointer;">
            <div class="ramadan-box">
                <p><span class="tr" data-bn="‡¶∏‡ßá‡¶π‡¶∞‡¶ø ‡¶∂‡ßá‡¶∑" data-en="Sehri Ends">‡¶∏‡ßá‡¶π‡¶∞‡¶ø ‡¶∂‡ßá‡¶∑</span></p>
                <span id="Sehri">--:--</span>
            </div>
            <div class="divider"></div>
            <div class="ramadan-box">
                <p><span class="tr" data-bn="‡¶á‡¶´‡¶§‡¶æ‡¶∞" data-en="Iftar">‡¶á‡¶´‡¶§‡¶æ‡¶∞</span></p>
                <span id="Iftar">--:--</span>
            </div>
        </div>

        <div class="card" onclick="toggleStatusView()" style="cursor: pointer; text-align: center;">
            <span id="prayerStatus" class="status-highlight">‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...</span>
            <span id="nextTime" class="next-time-inline"></span>
        </div>

        <div class="card">
            <div class="prayer-list">
                <div class="time-row" onclick="toggleRakat('fajr-r')"><span class="tr" data-bn="‡¶´‡¶ú‡¶∞" data-en="Fajr">‡¶´‡¶ú‡¶∞</span><span id="Fajr">--:--</span></div>
                <div id="fajr-r" class="rakat-info tr" data-bn="‡¶´‡¶ú‡¶∞: ‡ß™ ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§" data-en="Fajr: 4 Rakat">‡¶´‡¶ú‡¶∞: ‡ß™ ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§</div>
                
                <div class="time-row" onclick="toggleRakat('dhuhr-r')"><span class="tr" data-bn="‡¶Ø‡ßã‡¶π‡¶∞" data-en="Dhuhr">‡¶Ø‡ßã‡¶π‡¶∞</span><span id="Dhuhr">--:--</span></div>
                <div id="dhuhr-r" class="rakat-info tr" data-bn="‡¶Ø‡ßã‡¶π‡¶∞: ‡ßß‡ß® ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§" data-en="Dhuhr: 12 Rakat">‡¶Ø‡ßã‡¶π‡¶∞: ‡ßß‡ß® ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§</div>
                
                <div class="time-row" onclick="toggleRakat('asr-r')"><span class="tr" data-bn="‡¶Ü‡¶∏‡¶∞" data-en="Asr">‡¶Ü‡¶∏‡¶∞</span><span id="Asr">--:--</span></div>
                <div id="asr-r" class="rakat-info tr" data-bn="‡¶Ü‡¶∏‡¶∞: ‡ßÆ ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§" data-en="Asr: 8 Rakat">‡¶Ü‡¶∏‡¶∞: ‡ßÆ ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§</div>
                
                <div class="time-row" onclick="toggleRakat('maghrib-r')"><span class="tr" data-bn="‡¶Æ‡¶æ‡¶ó‡¶∞‡¶ø‡¶¨" data-en="Maghrib">‡¶Æ‡¶æ‡¶ó‡¶∞‡¶ø‡¶¨</span><span id="Maghrib">--:--</span></div>
                <div id="maghrib-r" class="rakat-info tr" data-bn="‡¶Æ‡¶æ‡¶ó‡¶∞‡¶ø‡¶¨: ‡ß≠ ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§" data-en="Maghrib: 7 Rakat">‡¶Æ‡¶æ‡¶ó‡¶∞‡¶ø‡¶¨: ‡ß≠ ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§</div>
                
                <div class="time-row" onclick="toggleRakat('isha-r')"><span class="tr" data-bn="‡¶è‡¶∂‡¶æ" data-en="Isha">‡¶è‡¶∂‡¶æ</span><span id="Isha">--:--</span></div>
                <div id="isha-r" class="rakat-info tr" data-bn="‡¶è‡¶∂‡¶æ: ‡ßß‡ß≠ ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§" data-en="Isha: 17 Rakat">‡¶è‡¶∂‡¶æ: ‡ßß‡ß≠ ‡¶∞‡¶æ‡¶ï‡¶æ‡¶§</div>
            </div>
        </div>
    </div>

    <div id="monthlyModal" class="modal">
        <div class="modal-content">
            <span style="float:right; cursor:pointer;" onclick="closeModal()">‚úñ</span>
            <h3 id="modalTitle" style="text-align: center; color: var(--neon);">‡ß©‡ß¶ ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶∏‡ßÇ‡¶ö‡ßÄ</h3>
            <div id="monthlyList"></div>
        </div>
    </div>

    <script>
        let pTimes = {};
        let timeOffset = 0;
        let currentLang = 'bn';
        const colors = ['#00d2ff', '#00ff88', '#ff3366', '#ffcc00', '#ae81ff', '#ffffff'];
        let colorIndex = 0;

        // ‡¶∞‡¶Ç ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡ßá‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function changeThemeColor() {
            colorIndex = (colorIndex + 1) % colors.length;
            document.documentElement.style.setProperty('--neon', colors[colorIndex]);
        }

        function toggleLang() {
            currentLang = currentLang === 'bn' ? 'en' : 'bn';
            document.getElementById('langBtn').innerText = currentLang === 'bn' ? 'English' : '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ';
            document.querySelectorAll('.tr').forEach(el => el.innerText = el.getAttribute(`data-${currentLang}`));
            updateStatus();
            loadData();
        }

        async function initApp() {
            // ‡¶Æ‡ßá‡¶∏‡ßá‡¶û‡ßç‡¶ú‡¶æ‡¶∞ ‡¶¨‡¶æ ‡¶á‡¶®-‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ö‡ßá‡¶ï
            try {
                const res = await fetch('https://worldtimeapi.org/api/timezone/Asia/Dhaka');
                const data = await res.json();
                timeOffset = new Date(data.datetime).getTime() - Date.now();
            } catch (e) { 
                console.log("Network error, using system time.");
                timeOffset = 0; 
            }
            fetchMonthly();
        }

        async function fetchMonthly() {
            const city = document.getElementById("city").value;
            const now = new Date(Date.now() + timeOffset);
            // ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ (‡¶Ø‡¶æ‡¶§‡ßá ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá)
            const cachedData = localStorage.getItem(`cache_${city}_${now.getMonth()}`);
            
            try {
                const res = await fetch(`https://api.aladhan.com/v1/calendarByCity?city=${city}&country=Bangladesh&method=1&month=${now.getMonth()+1}&year=${now.getFullYear()}`);
                const data = await res.json();
                localStorage.setItem(`cache_${city}_${now.getMonth()}`, JSON.stringify(data.data));
                updateUI(data.data);
            } catch (e) {
                if (cachedData) updateUI(JSON.parse(cachedData));
            }
        }

        function updateUI(monthlyData) {
            const now = new Date(Date.now() + timeOffset);
            const todayData = monthlyData[now.getDate() - 1];
            if(!todayData) return;
            pTimes = todayData.timings;

            ["Fajr", "Dhuhr", "Asr", "Maghrib", "Isha"].forEach(n => {
                document.getElementById(n).innerText = t12(pTimes[n]);
            });
            document.getElementById("Sehri").innerText = calculateSehri(pTimes.Fajr);
            document.getElementById("Iftar").innerText = t12(pTimes.Maghrib);
            document.getElementById("hijriDate").innerText = `${todayData.date.hijri.day} ${todayData.date.hijri.month.en} ${todayData.date.hijri.year} AH`;
            updateStatus();
        }

        function t12(t) {
            let [h, m] = t.split(' ')[0].split(':').map(Number);
            let s = h >= 12 ? ' PM' : ' AM';
            h = h % 12 || 12;
            let res = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}${s}`;
            return currentLang === 'bn' ? res.replace(/\d/g, d => "‡ß¶‡ßß‡ß®‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ‡ßØ"[d]) : res;
        }

        function calculateSehri(fajr) {
            let [h, m] = fajr.split(' ')[0].split(':').map(Number);
            let d = new Date(); d.setHours(h, m); d.setMinutes(d.getMinutes() - 5);
            let res = d.toLocaleTimeString('en-US', {hour:'2-digit', minute:'2-digit'});
            return currentLang === 'bn' ? res.replace(/\d/g, d => "‡ß¶‡ßß‡ß®‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ‡ßØ"[d]) : res;
        }

        function updateStatus() {
            if (!pTimes.Fajr) return;
            const now = new Date(Date.now() + timeOffset);
            const sch = [
                {bn:"‡¶´‡¶ú‡¶∞", en:"Fajr", t:pTimes.Fajr},
                {bn:"‡¶Ø‡ßã‡¶π‡¶∞", en:"Dhuhr", t:pTimes.Dhuhr},
                {bn:"‡¶Ü‡¶∏‡¶∞", en:"Asr", t:pTimes.Asr},
                {bn:"‡¶Æ‡¶æ‡¶ó‡¶∞‡¶ø‡¶¨", en:"Maghrib", t:pTimes.Maghrib},
                {bn:"‡¶è‡¶∂‡¶æ", en:"Isha", t:pTimes.Isha}
            ];
            let next = null;
            for (let p of sch) {
                let [h, m] = p.t.split(' ')[0].split(':');
                let target = new Date(now); target.setHours(h, m, 0);
                if (target > now) { next = {p, target}; break; }
            }
            if (!next) {
                let [h, m] = sch[0].t.split(' ')[0].split(':');
                let target = new Date(now); target.setDate(now.getDate()+1); target.setHours(h, m, 0);
                next = {p: sch[0], target};
            }
            const diff = Math.floor((next.target - now) / 60000);
            const hr = Math.floor(diff/60), min = diff%60;
            document.getElementById("prayerStatus").innerText = currentLang==='bn' ? `‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú: ${next.p.bn}` : `Next: ${next.p.en}`;
            document.getElementById("nextTime").innerText = currentLang==='bn' ? `(${hr}‡¶ò‡¶É ${min}‡¶Æ‡¶ø‡¶É ‡¶¨‡¶æ‡¶ï‡¶ø)` : `(${hr}h ${min}m left)`;
        }

        setInterval(() => {
            const now = new Date(Date.now() + timeOffset);
            const loc = currentLang === 'bn' ? 'bn-BD' : 'en-US';
            document.getElementById("clock").innerText = now.toLocaleTimeString(loc);
            document.getElementById("today").innerText = now.toLocaleDateString(loc, {weekday:'long', day:'numeric', month:'long'});
            updateStatus();
        }, 1000);

        function showMonthlySchedule() {
            document.getElementById("monthlyModal").style.display = "block";
            // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Æ‡¶æ‡¶®‡ßç‡¶•‡¶≤‡¶ø ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶•‡¶æ‡¶ï‡¶¨‡ßá
        }
        function closeModal() { document.getElementById("monthlyModal").style.display = "none"; }
        function toggleRakat(id) { document.getElementById(id).classList.toggle('show-rakat'); }
        function loadData() { fetchMonthly(); }

        window.onload = initApp;
    </script>
</body>
</html>
