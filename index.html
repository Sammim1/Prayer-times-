<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>X-FILES ULTRA PRO</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;600;900&display=swap');
body{background:#000;color:#fff;font-family:'Inter',sans-serif}
.glass{background:rgba(255,255,255,.03);backdrop-filter:blur(25px);
border:1px solid rgba(255,255,255,.08);border-radius:30px}
.active-tab{background:#3b82f6;color:#fff}
.file-card{border:1px solid rgba(255,255,255,.1);transition:.3s}
.file-card:hover{border-color:#3b82f6;transform:translateY(-4px)}
</style>
</head>

<body class="p-4 md:p-10">

<div class="max-w-5xl mx-auto">

<!-- HEADER -->
<div class="glass p-6 mb-6 flex justify-between items-center">
  <div>
    <h1 class="text-2xl font-black italic">
      X-FILES <span class="text-blue-500">ULTRA</span>
    </h1>
    <p id="eta-text" class="text-[10px] text-gray-400 uppercase">
      Ready
    </p>
  </div>

  <div class="flex bg-black/50 p-1 rounded-xl">
    <button id="tab-photo" onclick="setType('photo')" class="tab-btn active-tab px-4 py-2 rounded-lg text-xs font-bold">PHOTO</button>
    <button id="tab-video" onclick="setType('video')" class="tab-btn px-4 py-2 text-xs text-gray-400">VIDEO</button>
    <button id="tab-document" onclick="setType('document')" class="tab-btn px-4 py-2 text-xs text-gray-400">FILES</button>
  </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

<!-- LEFT -->
<div>
  <label class="glass h-48 flex flex-col items-center justify-center cursor-pointer border-2 border-dashed border-gray-700 hover:border-blue-500">
    <input type="file" id="fileInput" multiple class="hidden">
    <span id="upload-icon" class="text-5xl">üñºÔ∏è</span>
    <p class="text-[10px] text-gray-400 mt-2 uppercase">Add Files</p>
  </label>

  <button id="sendBtn" onclick="ignite()"
    class="w-full mt-5 py-4 bg-white text-black font-black rounded-2xl hover:bg-blue-600 hover:text-white">
    START TRANSFER
  </button>
</div>

<!-- RIGHT -->
<div class="lg:col-span-2 glass p-5 min-h-[400px]">
  <div class="flex justify-between mb-4">
    <div>Queue: <span id="q-count" class="text-blue-500 font-bold">0</span></div>
    <div>Sent: <span id="s-count" class="text-green-500 font-bold">0</span></div>
  </div>

  <div id="preview-grid" class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
</div>

</div>
</div>

<script>
/* ===== CONFIG ===== */
const TOKEN = "YOUR_BOT_TOKEN";
const CHAT_ID = "YOUR_CHAT_ID";

/* ===== STATE ===== */
let queue = [];
let currentType = "photo";

/* ===== TAB ===== */
function setType(type){
  currentType = type;
  document.querySelectorAll(".tab-btn").forEach(b=>{
    b.classList.remove("active-tab"); b.classList.add("text-gray-400");
  });
  document.getElementById("tab-"+type).classList.add("active-tab");
  document.getElementById("upload-icon").innerText =
    type==="photo"?"üñºÔ∏è":type==="video"?"üé¨":"üìÇ";
}

/* ===== FILE PICK ===== */
fileInput.onchange = e=>{
  queue.push(...e.target.files);
  render();
  e.target.value="";
};

function render(){
  preview-grid.innerHTML="";
  q-count.innerText = queue.length;
  queue.forEach((f,i)=>{
    const d=document.createElement("div");
    d.className="relative aspect-square rounded-xl overflow-hidden file-card bg-white/5 flex items-center justify-center";
    d.innerHTML = f.type.startsWith("image/")
      ? `<img src="${URL.createObjectURL(f)}" class="w-full h-full object-cover">`
      : `<div class="text-[9px] p-2 text-gray-400 break-all">${f.name}</div>`;
    preview-grid.appendChild(d);
  });
}

/* ===== BULLETPROOF SEND ===== */
async function ignite(){
  if(!queue.length) return;

  sendBtn.disabled=true;
  sendBtn.innerText="UPLOADING...";
  let sent=0;

  // PHOTO (10 per batch, retry until success)
  if(currentType==="photo"){
    for(let i=0;i<queue.length;i+=10){
      let batch=queue.slice(i,i+10);
      let ok=false;
      while(!ok){
        try{
          const fd=new FormData();
          fd.append("chat_id",CHAT_ID);
          fd.append("media",JSON.stringify(
            batch.map((_,x)=>({type:"photo",media:`attach://p${x}`}))
          ));
          batch.forEach((f,x)=>fd.append(`p${x}`,f));

          const r=await fetch(`https://api.telegram.org/bot${TOKEN}/sendMediaGroup`,
            {method:"POST",body:fd});

          if(r.ok){
            ok=true;
            sent+=batch.length;
            s-count.innerText=sent;
            q-count.innerText=queue.length-sent;
            eta-text.innerText=`Uploading ${sent}/${queue.length}`;
          } else await sleep(2000);
        }catch{ await sleep(2000); }
      }
    }
  }

  // VIDEO / FILE
  else{
    const api=currentType==="video"?"sendVideo":"sendDocument";
    for(let f of queue){
      let done=false;
      while(!done){
        try{
          const fd=new FormData();
          fd.append("chat_id",CHAT_ID);
          fd.append(currentType,f);
          const r=await fetch(`https://api.telegram.org/bot${TOKEN}/${api}`,
            {method:"POST",body:fd});
          if(r.ok){
            done=true; sent++;
            s-count.innerText=sent;
            q-count.innerText=queue.length-sent;
          } else await sleep(2000);
        }catch{ await sleep(2000); }
      }
    }
  }

  eta-text.innerText="ALL FILES SENT ‚úî";
  sendBtn.innerText="DONE";
}

const sleep = ms => new Promise(r=>setTimeout(r,ms));
</script>

</body>
</html>
